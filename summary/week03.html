<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.28.0/themes/prism.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@6.7.0"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.14.3"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.14.3/dist/index.umd.min.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const toolbar = new markmap.Toolbar();
  toolbar.attach(mm);
  const el = toolbar.render();
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root, jsonOptions) => {
        const markmap = getMarkmap();
        window.mm = markmap.Markmap.create('svg#mindmap', (getOptions || markmap.deriveOptions)(jsonOptions), root);
      })(() => window.markmap,null,{"type":"root","depth":0,"content":"","children":[{"type":"heading","depth":1,"payload":{"lines":[0,1]},"content":"手写数组的方法","children":[{"type":"heading","depth":2,"payload":{"lines":[2,3]},"content":"Array.isArray","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[4,6]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[4,5]},"content":"基本使用：判断一个值是否是数组类型"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> proxy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>proxy<span class=\"token punctuation\">.</span><span class=\"token property-access\">__proto__</span> <span class=\"token operator\">===</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>proxy <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toSrting</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">Proxy</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [object Function]</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// undefined</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>proxy <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 报错，没有原型</span>\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[16,18]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[16,17]},"content":"实现"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">isArray</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">obj</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> obj <span class=\"token operator\">!==</span> <span class=\"token string\">'obj'</span> <span class=\"token operator\">||</span> obj <span class=\"token operator\">===</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">return</span> obj <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[27,28]},"content":"Array.prototype.entries","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[29,32]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[29,30]},"content":"定义：返回一个新的 Array Iteator 对象，该对象包含数组中每个索引的键值对"},{"type":"list_item","depth":4,"payload":{"lines":[30,31]},"content":"举例"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Object [Array Iterator] {}</span>\n<span class=\"token comment\">// next访问</span>\n<span class=\"token keyword\">const</span> iter <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>iter<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// {value: [0, ''], done:false}</span>\n\n<span class=\"token comment\">// for of 迭代</span>\n<span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>k<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">]</span> <span class=\"token keyword\">of</span> arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">entries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 0 ''  1 undefined   2 null   3 {}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[45,47]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[45,46]},"content":"next 实现"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 未优化：</span>\n<span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">entries</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">O</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>index<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">done</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">done</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span>\n  next<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">iterator</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> next\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 优化后：</span>\n<span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">[</span><span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">iterator</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">O</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> index <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>index <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>index<span class=\"token operator\">++</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">done</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">value</span><span class=\"token operator\">:</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">done</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span>\n    next<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n\n<span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">entries</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">O</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> length <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> entries <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    entries<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">,</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> itr <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">[</span><span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">iterator</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">bind</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">next</span><span class=\"token operator\">:</span> itr<span class=\"token punctuation\">.</span><span class=\"token property-access\">next</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span><span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">iterator</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> itr<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[101,106]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[101,102]},"content":"考察点：","children":[{"type":"list_item","depth":5,"payload":{"lines":[102,103]},"content":"迭代器本质和实现"},{"type":"list_item","depth":5,"payload":{"lines":[103,104]},"content":"ES6 Symbol 符号"},{"type":"list_item","depth":5,"payload":{"lines":[104,105]},"content":"逻辑复用"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[106,107]},"content":"Array.prototype.includes","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[108,110]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[108,109]},"content":"实现"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token known-class-name class-name\">Number</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">isNaN</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> num <span class=\"token operator\">===</span> <span class=\"token string\">'number'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token function\">isNaN</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">includes</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">item<span class=\"token punctuation\">,</span> fromIndex</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// call、apply调用，严格模式</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span> <span class=\"token operator\">==</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'无效的this!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> <span class=\"token constant\">O</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> len <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>length <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> isNaN <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Number</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isNaN</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>isNaN <span class=\"token operator\">&amp;&amp;</span> <span class=\"token known-class-name class-name\">Number</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isNaN</span><span class=\"token punctuation\">(</span><span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[138,139]},"content":"Array.from","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[140,146]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[140,141]},"content":"三个参数 Array.from(arrayLike,mapFn,thisArg)","children":[{"type":"list_item","depth":5,"payload":{"lines":[141,142]},"content":"arrayLike：类数组对象或者可遍历对象(Map,Set 等)"},{"type":"list_item","depth":5,"payload":{"lines":[142,143]},"content":"mapFn：可选参数，在最后生成数组后执行一次 map 方法后返回"},{"type":"list_item","depth":5,"payload":{"lines":[143,144]},"content":"thisArg；可选参数，实际是 Array.from(obj).map(mapFn，this.Arg)"}]},{"type":"list_item","depth":4,"payload":{"lines":[144,145]},"content":"实现"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">isCallable</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">typeof</span> fn <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">||</span>\n    <span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toString</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>fn<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'[object Function]'</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">from</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">arrayLike<span class=\"token punctuation\">,</span> mapFn<span class=\"token punctuation\">,</span> thisArg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">C</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// 判断对象是否为null</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>arrayLike <span class=\"token operator\">==</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'对象为空'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// 判断mapFn是否为函数</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> mapFn <span class=\"token operator\">!==</span> <span class=\"token string\">'function'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">typeof</span> mapFn <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'mapFn不是方法'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> items <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span>arrayLike<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> len <span class=\"token operator\">=</span> items<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">>></span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> <span class=\"token function\">isCallable</span><span class=\"token punctuation\">(</span><span class=\"token constant\">C</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">C</span><span class=\"token punctuation\">(</span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">(</span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> value <span class=\"token operator\">=</span> items<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>mapFn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token constant\">A</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span>\n        <span class=\"token keyword\">typeof</span> thisArg <span class=\"token operator\">===</span> <span class=\"token string\">'undefined'</span>\n          <span class=\"token operator\">?</span> <span class=\"token function\">mapFn</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">:</span> mapFn<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>thisArg<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token constant\">A</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token constant\">A</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[182,187]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[182,183]},"content":"观察点","children":[{"type":"list_item","depth":5,"payload":{"lines":[183,184]},"content":"类数组的特征"},{"type":"list_item","depth":5,"payload":{"lines":[184,185]},"content":"length 为字符串的处理（2 的 32 次方-1）"},{"type":"list_item","depth":5,"payload":{"lines":[185,186]},"content":"from 函数本身 this 也是可以被改写的"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[187,188]},"content":"Array.prototype.flat","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[189,193]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[189,190]},"content":"定义：指定的深度递归遍历数组，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回"},{"type":"list_item","depth":4,"payload":{"lines":[191,192]},"content":"实现："}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 网络版：</span>\n<span class=\"token keyword\">const</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// reduce遇到空位会跳过</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">flat</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">arr</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">preduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">pre<span class=\"token punctuation\">,</span> cur</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> pre<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">concat</span><span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isArray</span><span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token function\">flat</span><span class=\"token punctuation\">(</span>cur<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> cur<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">flat</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [1,1]</span>\n\n<span class=\"token comment\">// 靠谱版：</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">has</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj<span class=\"token punctuation\">,</span> key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">hasOwn</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">flat</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">deep</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> <span class=\"token constant\">O</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> sourceLen <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> depthNum <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>deep <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    depthNum <span class=\"token operator\">=</span> deep<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>depthNum <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> val<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> sourceLen<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>has<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token constant\">O</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      val <span class=\"token operator\">=</span> <span class=\"token constant\">O</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token known-class-name class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">isArray</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span>arr<span class=\"token punctuation\">,</span> val<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">flat</span><span class=\"token punctuation\">(</span>depthNum <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token punctuation\">{</span>\n        arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token punctuation\">{</span>\n      arr<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]}]},{"type":"heading","depth":1,"payload":{"lines":[235,236]},"content":"数据合并","children":[{"type":"list_item","depth":2,"payload":{"lines":[237,238]},"content":"双层 for 循环 + key"},{"type":"list_item","depth":2,"payload":{"lines":[238,239]},"content":"单层 for 循环 + map + key"},{"type":"list_item","depth":2,"payload":{"lines":[239,240]},"content":"求助开源"}]},{"type":"heading","depth":1,"payload":{"lines":[241,242]},"content":"IIFE，闭包，作用域等等概念"},{"type":"heading","depth":1,"payload":{"lines":[243,244]},"content":"执行上下文","children":[{"type":"bullet_list","depth":2,"payload":{"lines":[245,259]},"content":"","children":[{"type":"list_item","depth":3,"payload":{"lines":[245,246]},"content":"定义：JS 代码被解析和执行时的环境（程序角度）"},{"type":"list_item","depth":3,"payload":{"lines":[246,247]},"content":"环境分类","children":[{"type":"list_item","depth":4,"payload":{"lines":[247,248]},"content":"this"},{"type":"list_item","depth":4,"payload":{"lines":[248,249]},"content":"变量环境","children":[{"type":"list_item","depth":5,"payload":{"lines":[249,250]},"content":"var"}]},{"type":"list_item","depth":4,"payload":{"lines":[250,251]},"content":"词法环境","children":[{"type":"list_item","depth":5,"payload":{"lines":[251,252]},"content":"let"},{"type":"list_item","depth":5,"payload":{"lines":[252,253]},"content":"const"}]},{"type":"list_item","depth":4,"payload":{"lines":[253,254]},"content":"外部环境"}]},{"type":"list_item","depth":3,"payload":{"lines":[254,255]},"content":"上下文分类","children":[{"type":"list_item","depth":4,"payload":{"lines":[255,256]},"content":"全局上下文"},{"type":"list_item","depth":4,"payload":{"lines":[256,257]},"content":"函数执行上下文"},{"type":"list_item","depth":4,"payload":{"lines":[257,258]},"content":"eval 函数执行上下文"}]}]},{"type":"heading","depth":2,"payload":{"lines":[259,260]},"content":"执行栈/调用栈","children":[{"type":"list_item","depth":3,"payload":{"lines":[261,262]},"content":"定义：是一个拥有数据结构的栈，被用来存储代码运行时创建的所有执行上下文。"}]},{"type":"heading","depth":2,"payload":{"lines":[263,264]},"content":"作用域","children":[{"type":"list_item","depth":3,"payload":{"lines":[265,266]},"content":"定义：一个独立的区域。主要用途就是隔离变量。"},{"type":"list_item","depth":3,"payload":{"lines":[266,267]},"content":"分类：","children":[{"type":"list_item","depth":4,"payload":{"lines":[267,268]},"content":"全局作用域：window/global"},{"type":"list_item","depth":4,"payload":{"lines":[268,269]},"content":"函数作用域：函数"},{"type":"list_item","depth":4,"payload":{"lines":[269,270]},"content":"块级作用域：{}包裹的代码块"}]}]},{"type":"heading","depth":2,"payload":{"lines":[271,272]},"content":"作用域链","children":[{"type":"list_item","depth":3,"payload":{"lines":[273,274]},"content":"定义：作用域根据代码层次分层，以便于作用域可以访问父作用域，而不能从父作用域引用子作用域中的变量和引用。"}]},{"type":"heading","depth":2,"payload":{"lines":[275,276]},"content":"执行上下文和作用域的区别","children":[{"type":"list_item","depth":3,"payload":{"lines":[277,278]},"content":"创建时间：","children":[{"type":"list_item","depth":4,"payload":{"lines":[278,279]},"content":"作用域：函数创建时已确定"},{"type":"list_item","depth":4,"payload":{"lines":[279,280]},"content":"上下文：运行时创建"}]},{"type":"list_item","depth":3,"payload":{"lines":[280,281]},"content":"运行机制：","children":[{"type":"list_item","depth":4,"payload":{"lines":[281,282]},"content":"作用域：静态（代码分析阶段就确定了）"},{"type":"list_item","depth":4,"payload":{"lines":[282,283]},"content":"上下文：动态（边执行边变化）"}]}]},{"type":"heading","depth":2,"payload":{"lines":[284,285]},"content":"变量提升","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[286,288]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[286,287]},"content":"定义：能够访问后声明的变量。"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// undefined</span>\n<span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'jack'</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack'</span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[294,295]},"content":"暂时性死区","children":[{"type":"list_item","depth":3,"payload":{"lines":[296,297]},"content":"定义：let 和 const 显示赋值之前，不能读写变量，否则报错。"}]},{"type":"heading","depth":2,"payload":{"lines":[298,299]},"content":"闭包","children":[{"type":"list_item","depth":3,"payload":{"lines":[300,301]},"content":"定义：内部函数能够访问上层作用域的变量对象。"}]},{"type":"heading","depth":2,"payload":{"lines":[302,303]},"content":"IIFE","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[304,306]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[304,305]},"content":"定义：立即执行函数表达式。"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num1<span class=\"token punctuation\">,</span> num2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>num1 <span class=\"token operator\">+</span> num2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]}]},{"type":"heading","depth":1,"payload":{"lines":[312,313]},"content":"name,length,caller 等重要属性","children":[{"type":"heading","depth":2,"payload":{"lines":[314,315]},"content":"Function.name","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[316,318]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[316,317]},"content":"使用场景：查看日志、性能优化、错误排查等需要精确到函数的地方"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num1<span class=\"token punctuation\">,</span> num2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> num1 <span class=\"token operator\">+</span> num2<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>sum<span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'sum'</span>\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[325,332]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[325,326]},"content":"分类","children":[{"type":"list_item","depth":5,"payload":{"lines":[326,327]},"content":"函数声明：函数名"},{"type":"list_item","depth":5,"payload":{"lines":[327,328]},"content":"匿名函数：空字符串"},{"type":"list_item","depth":5,"payload":{"lines":[328,329]},"content":"动态赋值：属性名"},{"type":"list_item","depth":5,"payload":{"lines":[329,330]},"content":"new Function：'anonymous'"},{"type":"list_item","depth":5,"payload":{"lines":[330,331]},"content":"bind 改变 this：bound + 函数名"}]}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[332,333]},"content":"this 解析","children":[{"type":"bullet_list","depth":2,"payload":{"lines":[334,338]},"content":"","children":[{"type":"list_item","depth":3,"payload":{"lines":[334,335]},"content":"定义：执行上下文（global，function，eval）的一个属性"},{"type":"list_item","depth":3,"payload":{"lines":[335,336]},"content":"在非严格模式下，总是指向一个对象。"},{"type":"list_item","depth":3,"payload":{"lines":[336,337]},"content":"严格模式下，可以是任意值。"}]},{"type":"heading","depth":2,"payload":{"lines":[338,339]},"content":"this 绑定规则","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[340,348]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[340,341]},"content":"规则列表：","children":[{"type":"list_item","depth":5,"payload":{"lines":[342,343]},"content":"默认绑定"},{"type":"list_item","depth":5,"payload":{"lines":[343,344]},"content":"隐式绑定"},{"type":"list_item","depth":5,"payload":{"lines":[344,345]},"content":"显示绑定"},{"type":"list_item","depth":5,"payload":{"lines":[345,346]},"content":"new"},{"type":"list_item","depth":5,"payload":{"lines":[346,347]},"content":"箭头函数"}]}]},{"type":"heading","depth":3,"payload":{"lines":[348,349]},"content":"默认绑定","children":[{"type":"list_item","depth":4,"payload":{"lines":[350,351]},"content":"非严格模式","children":[{"type":"list_item","depth":5,"payload":{"lines":[351,352]},"content":"浏览器：this 指向 window"},{"type":"list_item","depth":5,"payload":{"lines":[352,353]},"content":"nodejs：this 指向 global 对象"}]},{"type":"list_item","depth":4,"payload":{"lines":[353,354]},"content":"严格模式","children":[{"type":"list_item","depth":5,"payload":{"lines":[354,355]},"content":"浏览器：undefined"},{"type":"list_item","depth":5,"payload":{"lines":[355,356]},"content":"nodejs：undefined"}]}]},{"type":"heading","depth":3,"payload":{"lines":[357,358]},"content":"隐式绑定","children":[{"type":"list_item","depth":4,"payload":{"lines":[359,360]},"content":"作为某个对象属性被调用的那个对象"},{"type":"list_item","depth":4,"payload":{"lines":[360,361]},"content":"多级，就近原则"}]},{"type":"heading","depth":3,"payload":{"lines":[362,363]},"content":"显示绑定","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[364,370]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[364,365]},"content":"几种方式：","children":[{"type":"list_item","depth":6,"payload":{"lines":[365,366]},"content":"Function.prototype.call"},{"type":"list_item","depth":6,"payload":{"lines":[366,367]},"content":"Function.prototype.apply"},{"type":"list_item","depth":6,"payload":{"lines":[367,368]},"content":"Function.rototype.bind"},{"type":"list_item","depth":6,"payload":{"lines":[368,369]},"content":"属性绑定符"}]}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'sam'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'jack'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> obj1 <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'rose'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// call：直接调用函数，后面的参数是单个形式</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack'</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'sam' 全局的this</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'sam' 全局的this</span>\n<span class=\"token comment\">// apply：直接调用函数，后面的参数是数组形式</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack'</span>\n<span class=\"token comment\">// bind：间接调用函数，后面的参数是单个形式</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">bind</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack'</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>getName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">bind</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">bind</span><span class=\"token punctuation\">(</span>obj1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack' 只会绑定第一个bind</span>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[388,389]},"content":"new","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[390,395]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[390,391]},"content":"实例化一个函数或者 ES6 的 class"},{"type":"list_item","depth":5,"payload":{"lines":[391,392]},"content":"对于 Function，return 会影响返回值","children":[{"type":"list_item","depth":6,"payload":{"lines":[392,393]},"content":"return 的是一个非对象，直接返回内部的值"},{"type":"list_item","depth":6,"payload":{"lines":[393,394]},"content":"return 的是一个对象，直接返回该对象"}]}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\"><span class=\"token maybe-class-name\">Person</span></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">getName</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> person <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Person</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jack'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'jack'</span>\n<span class=\"token comment\">// return 的影响</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myObj1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">=</span> <span class=\"token string\">'obj1'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myObj2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">=</span> <span class=\"token string\">'obj2'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'jack'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">myObj3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">=</span> <span class=\"token string\">'obj3'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword nil\">undefined</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">myObj1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// myObj1 {name:'obj1'}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">myObj2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// {name:'jack'}</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">myObj3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// myObj3 {name:'obj3'}</span>\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[423,429]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[423,424]},"content":"new 实现原理","children":[{"type":"list_item","depth":6,"payload":{"lines":[424,425]},"content":"创建一个空对象"},{"type":"list_item","depth":6,"payload":{"lines":[425,426]},"content":"设置空对象的原型"},{"type":"list_item","depth":6,"payload":{"lines":[426,427]},"content":"执行构造函数，把相关属性和方法添加到对象上"},{"type":"list_item","depth":6,"payload":{"lines":[427,428]},"content":"返回对象。如果构造函数返回的值是对象类型，就直接返回该对象；反之，返回第一步创建的对象。"}]}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">myNew</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">constructor</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> args <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  obj<span class=\"token punctuation\">.</span><span class=\"token property-access\">__proto__</span> <span class=\"token operator\">==</span> constructor<span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> res <span class=\"token operator\">=</span> constructor<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword control-flow\">return</span> res <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Object</span> <span class=\"token operator\">?</span> res <span class=\"token operator\">:</span> obj<span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[439,440]},"content":"箭头函数","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[441,447]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[441,442]},"content":"特征：","children":[{"type":"list_item","depth":6,"payload":{"lines":[442,443]},"content":"简单"},{"type":"list_item","depth":6,"payload":{"lines":[443,444]},"content":"没有自己的 this,arguments,super,new.target"},{"type":"list_item","depth":6,"payload":{"lines":[444,445]},"content":"适合需要匿名函数的地方"},{"type":"list_item","depth":6,"payload":{"lines":[445,446]},"content":"不能用于构造函数"}]}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'global name'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> person <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'person name'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// this跟getName的this一样</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'person name'</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>person<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getName</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'name'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'name'</span>\n</code></pre>\n"}]}]},{"type":"heading","depth":2,"payload":{"lines":[459,460]},"content":"this 绑定的优先级","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[461,468]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[461,462]},"content":"优先级","children":[{"type":"list_item","depth":5,"payload":{"lines":[462,463],"index":1},"content":"1. 箭头函数"},{"type":"list_item","depth":5,"payload":{"lines":[463,464],"index":2},"content":"2. 显示绑定"},{"type":"list_item","depth":5,"payload":{"lines":[464,465],"index":3},"content":"3. new"},{"type":"list_item","depth":5,"payload":{"lines":[465,466],"index":4},"content":"4. 隐式绑定"},{"type":"list_item","depth":5,"payload":{"lines":[466,467],"index":5},"content":"5. 默认绑定"}]}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> name <span class=\"token operator\">=</span> <span class=\"token string\">'window'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'张三'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">logName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">logName2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">var</span> person <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'person'</span><span class=\"token punctuation\">,</span>\n  logName<span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">logName2</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token function\">logName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">logName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// window</span>\nperson<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">logName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// person</span>\nperson<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">logName2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// window</span>\nlogName<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">bind</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// '张三'</span>\n<span class=\"token function\">logName2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//  报错</span>\n</code></pre>\n"}]}]},{"type":"heading","depth":1,"payload":{"lines":[490,491]},"content":"call 知识点","children":[{"type":"fence","depth":2,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\na<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'a'</span>\na<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'b'</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'b'</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">,</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 'b'</span>\n</code></pre>\n"},{"type":"fence","depth":2,"content":"<pre class=\"language-js\"><code class=\"language-js\">fun<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span><span class=\"token spread operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">.</span><span class=\"token property-access\">fun</span><span class=\"token operator\">=</span>fun<span class=\"token punctuation\">;</span>obj<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">fun</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre>\n"},{"type":"fence","depth":2,"content":"<pre class=\"language-js\"><code class=\"language-js\">a<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> a被调用\na<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>：a<span class=\"token punctuation\">.</span><span class=\"token property-access\">call被调用</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>：a<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call被调用</span>\n<span class=\"token comment\">//</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token operator\">===</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token comment\">// true</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token operator\">===</span> a<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token comment\">// true</span>\na<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token operator\">===</span> a<span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">call</span> <span class=\"token comment\">// true</span>\n</code></pre>\n"}]},{"type":"heading","depth":1,"payload":{"lines":[519,520]},"content":"纯函数，副作用，高阶函数等函数式编程概念","children":[{"type":"heading","depth":2,"payload":{"lines":[521,522]},"content":"编程范式 - 面向过程编程","children":[{"type":"list_item","depth":3,"payload":{"lines":[523,524]},"content":"特点：主要采用过程调用或函数调用的方式来进行流程控制。流程则由包含一系列的运算步骤的过程，子程序，方法或者函数控制。"}]},{"type":"heading","depth":2,"payload":{"lines":[525,526]},"content":"编程范式 - 面向对象编程","children":[{"type":"list_item","depth":3,"payload":{"lines":[527,528]},"content":"特点：它将对象作为程序的基本单元，将程序和数据封装其中，以提高软件的重用性，灵活性和扩展性，对象里可以访问经常修改对象相关连的数据。在面向对象程序编程里，计算机程序会被设计成彼此相关的对象。"}]},{"type":"heading","depth":2,"payload":{"lines":[529,530]},"content":"编程范式 - 函数式编程","children":[{"type":"list_item","depth":3,"payload":{"lines":[531,532]},"content":"特点：函数式编程更加强调程序执行的结果而非执行的过程，倡导利用若干简单的执行单元让计算结果不断渐进，逐层推到复杂的计算，而不是设计一个复杂的执行过程。"},{"type":"list_item","depth":3,"payload":{"lines":[532,533]},"content":"优点：","children":[{"type":"list_item","depth":4,"payload":{"lines":[533,534]},"content":"代码简洁，优雅"},{"type":"list_item","depth":4,"payload":{"lines":[534,535]},"content":"语法灵活，复用性高"},{"type":"list_item","depth":4,"payload":{"lines":[535,536]},"content":"容易测试"},{"type":"list_item","depth":4,"payload":{"lines":[536,537]},"content":"易升级"},{"type":"list_item","depth":4,"payload":{"lines":[537,538]},"content":"并发友好"},{"type":"list_item","depth":4,"payload":{"lines":[538,539]},"content":"可维护性好"}]}]},{"type":"heading","depth":2,"payload":{"lines":[540,541]},"content":"纯函数","children":[{"type":"list_item","depth":3,"payload":{"lines":[542,543]},"content":"定义：纯函数就是相同的输入，永远得到相同的输出，并且没有任何副作用。"},{"type":"list_item","depth":3,"payload":{"lines":[543,544]},"content":"优点：","children":[{"type":"list_item","depth":4,"payload":{"lines":[544,545]},"content":"安全：无副作用，不破坏外面的状态"},{"type":"list_item","depth":4,"payload":{"lines":[545,546]},"content":"可测试：入参固定，输出固定，好断言"},{"type":"list_item","depth":4,"payload":{"lines":[546,547]},"content":"可缓存：同入同出，便于缓存，提升效率"}]}]},{"type":"heading","depth":2,"payload":{"lines":[548,549]},"content":"函数副作用","children":[{"type":"list_item","depth":3,"payload":{"lines":[550,551]},"content":"定义：函数调用时，除了返回函数值之外，还对外界产生附加的影响。"},{"type":"list_item","depth":3,"payload":{"lines":[551,552]},"content":"举例：","children":[{"type":"list_item","depth":4,"payload":{"lines":[552,553]},"content":"修改变量"},{"type":"list_item","depth":4,"payload":{"lines":[553,554]},"content":"修改参数"},{"type":"list_item","depth":4,"payload":{"lines":[554,555]},"content":"输出日志"},{"type":"list_item","depth":4,"payload":{"lines":[555,556]},"content":"操作 DOM"},{"type":"list_item","depth":4,"payload":{"lines":[556,557]},"content":"发送了 http 请求"},{"type":"list_item","depth":4,"payload":{"lines":[557,558]},"content":"操作客户端存储"},{"type":"list_item","depth":4,"payload":{"lines":[558,559]},"content":"与 service,iframe 通讯"},{"type":"list_item","depth":4,"payload":{"lines":[559,560]},"content":"其他不该做的事情"}]}]},{"type":"heading","depth":2,"payload":{"lines":[561,562]},"content":"高阶函数","children":[{"type":"list_item","depth":3,"payload":{"lines":[563,564]},"content":"定义：就是一个接受函数作为参数或则函数作为输出返回的函数"},{"type":"list_item","depth":3,"payload":{"lines":[564,565]},"content":"特征：函数入参或者返回函数"},{"type":"list_item","depth":3,"payload":{"lines":[565,566]},"content":"数组中的高阶函数","children":[{"type":"list_item","depth":4,"payload":{"lines":[566,567]},"content":"Array.prototype.filter"},{"type":"list_item","depth":4,"payload":{"lines":[567,568]},"content":"Array.prototype.find"},{"type":"list_item","depth":4,"payload":{"lines":[568,569]},"content":"Array.prototype.map"}]},{"type":"list_item","depth":3,"payload":{"lines":[569,570]},"content":"应用：","children":[{"type":"list_item","depth":4,"payload":{"lines":[570,571]},"content":"柯里化"},{"type":"list_item","depth":4,"payload":{"lines":[571,572]},"content":"Function.prototype.bind"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[573,574]},"content":"深入原型链","children":[{"type":"bullet_list","depth":2,"payload":{"lines":[575,579]},"content":"","children":[{"type":"list_item","depth":3,"payload":{"lines":[575,576]},"content":"原型的好处","children":[{"type":"list_item","depth":4,"payload":{"lines":[576,577]},"content":"共享数据，减小空间占用，节省内存"},{"type":"list_item","depth":4,"payload":{"lines":[577,578]},"content":"实现继承"}]}]},{"type":"heading","depth":2,"payload":{"lines":[579,580]},"content":"原型三件套","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[581,586]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[581,582]},"content":"三个属性","children":[{"type":"list_item","depth":5,"payload":{"lines":[582,583]},"content":"prototype：原型"},{"type":"list_item","depth":5,"payload":{"lines":[583,584]},"content":"constructor：构造函数"},{"type":"list_item","depth":5,"payload":{"lines":[584,585]},"content":"__proto__：访问器属性（getter 函数 + setter 函数），用于暴露 prototype 内部"}]}]},{"type":"heading","depth":3,"payload":{"lines":[586,587]},"content":"prototype","children":[{"type":"list_item","depth":4,"payload":{"lines":[588,589]},"content":"特征：","children":[{"type":"list_item","depth":5,"payload":{"lines":[590,591]},"content":"prototype 属性是一个普通对象"},{"type":"list_item","depth":5,"payload":{"lines":[591,592]},"content":"普通对象都有一个__proto__属性"},{"type":"list_item","depth":5,"payload":{"lines":[592,593]},"content":"普通函数或者 class 既有 prototype 属性，又有__ptoto__"}]},{"type":"list_item","depth":4,"payload":{"lines":[594,596]},"content":"理解：<br>\n<image src=\"./images/02.png\" ></image>"}]}]},{"type":"heading","depth":2,"payload":{"lines":[597,598]},"content":"总结","children":[{"type":"list_item","depth":3,"payload":{"lines":[599,600]},"content":"知识点：","children":[{"type":"list_item","depth":4,"payload":{"lines":[600,601]},"content":"函数本质是对象"},{"type":"list_item","depth":4,"payload":{"lines":[601,602]},"content":"普通对象的 constructor 指向自己的构造函数，可以被改变，不安全"},{"type":"list_item","depth":4,"payload":{"lines":[602,603]},"content":"函数和 class 的 prototype.constructor 指向函数自身"},{"type":"list_item","depth":4,"payload":{"lines":[603,604]},"content":"Function，Object，Regexp，Error 等本质是函数，Function.constructor === Function"},{"type":"list_item","depth":4,"payload":{"lines":[604,605]},"content":"普通对象都有__proto__，其等于构造函数的原型，推荐使用 Object.getPrototypeOf"},{"type":"list_item","depth":4,"payload":{"lines":[605,606]},"content":"原型链的尽头是 null，Object.prototype.__proto__ === null"},{"type":"list_item","depth":4,"payload":{"lines":[606,607]},"content":"Function.__proto__指向 Function.prototype"},{"type":"list_item","depth":4,"payload":{"lines":[607,608]},"content":"普通对象的二次__proto__指向 null"},{"type":"list_item","depth":4,"payload":{"lines":[608,609]},"content":"普通函数的三次__proto__指向 null"},{"type":"list_item","depth":4,"payload":{"lines":[609,610]},"content":"经过 n 次显式继承，被实例化的对象，n+3 的__proto__是 null"}]}]},{"type":"heading","depth":2,"payload":{"lines":[611,612]},"content":"纯净对象","children":[{"type":"list_item","depth":3,"payload":{"lines":[613,614]},"content":"定义：没有原型的对象"},{"type":"list_item","depth":3,"payload":{"lines":[614,615]},"content":"优点：节约内存空间"},{"type":"list_item","depth":3,"payload":{"lines":[615,616]},"content":"创建：Object.create(null)"}]},{"type":"heading","depth":2,"payload":{"lines":[617,618]},"content":"组合与继承","children":[{"type":"heading","depth":3,"payload":{"lines":[619,620]},"content":"组合（has-a 关系）","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[621,625]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[621,622]},"content":"定义：在一个类/对象内使用其他的类/对象"},{"type":"list_item","depth":5,"payload":{"lines":[622,623]},"content":"has-a：包含关系，体现的是<strong>整体和部分</strong>的思想"},{"type":"list_item","depth":5,"payload":{"lines":[623,624]},"content":"<strong>黑盒复用</strong>：对象内部的细节不可见，只要知道怎么使用，调 api 就行"}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Logger</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">error</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Report</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">logger</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">logger</span> <span class=\"token operator\">=</span> logger <span class=\"token operator\">||</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Logger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">logger</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'report'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[644,654]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[644,645]},"content":"优点：","children":[{"type":"list_item","depth":6,"payload":{"lines":[645,646]},"content":"功能相对独立，松耦合"},{"type":"list_item","depth":6,"payload":{"lines":[646,647]},"content":"扩展性好"},{"type":"list_item","depth":6,"payload":{"lines":[647,648]},"content":"符合单一职责，复用性好"},{"type":"list_item","depth":6,"payload":{"lines":[648,649]},"content":"支持动态组合，即程序运行中组合"},{"type":"list_item","depth":6,"payload":{"lines":[649,650]},"content":"具备按需组装的能力"}]},{"type":"list_item","depth":5,"payload":{"lines":[650,651]},"content":"缺点：","children":[{"type":"list_item","depth":6,"payload":{"lines":[651,652]},"content":"使用上相比继承，更为复杂"},{"type":"list_item","depth":6,"payload":{"lines":[652,653]},"content":"容易产生过多的类和对象"}]}]}]},{"type":"heading","depth":3,"payload":{"lines":[654,655]},"content":"继承（is- a 关系）","children":[{"type":"list_item","depth":4,"payload":{"lines":[656,657]},"content":"特征","children":[{"type":"list_item","depth":5,"payload":{"lines":[657,658]},"content":"继承是 is-a 关系，比如人和动物"},{"type":"list_item","depth":5,"payload":{"lines":[658,659]},"content":"白盒复用：你需要了解弗雷具体实现，从而决定怎么重写父类"}]},{"type":"list_item","depth":4,"payload":{"lines":[659,660]},"content":"优点：","children":[{"type":"list_item","depth":5,"payload":{"lines":[660,661]},"content":"初始化简单，子类具备父类的能力"},{"type":"list_item","depth":5,"payload":{"lines":[661,662]},"content":"无需显式初始化父类"}]},{"type":"list_item","depth":4,"payload":{"lines":[662,663]},"content":"缺点：","children":[{"type":"list_item","depth":5,"payload":{"lines":[663,664]},"content":"继承层级多，导致代码可读性差"},{"type":"list_item","depth":5,"payload":{"lines":[664,665]},"content":"耦合紧"},{"type":"list_item","depth":5,"payload":{"lines":[665,666]},"content":"扩展性相对较差"}]}]},{"type":"heading","depth":3,"payload":{"lines":[667,668]},"content":"组合与继承的目的：逻辑复用，代码复用"},{"type":"heading","depth":3,"payload":{"lines":[669,670]},"content":"多态","children":[{"type":"list_item","depth":4,"payload":{"lines":[671,672]},"content":"定义：事物在运行过程中存在不同的状态"},{"type":"list_item","depth":4,"payload":{"lines":[672,673]},"content":"形成条件：","children":[{"type":"list_item","depth":5,"payload":{"lines":[673,674]},"content":"需要有继承关系"},{"type":"list_item","depth":5,"payload":{"lines":[674,675]},"content":"子类重写父类的方法"},{"type":"list_item","depth":5,"payload":{"lines":[675,676]},"content":"父类指向子类"}]}]},{"type":"heading","depth":3,"payload":{"lines":[677,678]},"content":"使用场景","children":[{"type":"list_item","depth":4,"payload":{"lines":[679,680]},"content":"有多态需求时，使用继承"},{"type":"list_item","depth":4,"payload":{"lines":[680,681]},"content":"有多重继承的需求，使用组合"},{"type":"list_item","depth":4,"payload":{"lines":[681,682]},"content":"有多态 + 多重继承需求时，继承 + 组合"}]},{"type":"heading","depth":3,"payload":{"lines":[683,684]},"content":"ES5 继承方式","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[685,695]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[685,686]},"content":"原型链继承"},{"type":"list_item","depth":5,"payload":{"lines":[686,687]},"content":"构造函数继承"},{"type":"list_item","depth":5,"payload":{"lines":[687,688]},"content":"原型式继承"},{"type":"list_item","depth":5,"payload":{"lines":[688,689]},"content":"组合继承"},{"type":"list_item","depth":5,"payload":{"lines":[689,690]},"content":"寄生式继承"},{"type":"list_item","depth":5,"payload":{"lines":[690,691]},"content":"寄生组合继承","children":[{"type":"list_item","depth":6,"payload":{"lines":[691,692]},"content":"各个实例属性相互独立，不会发生修改一个实例，影响另一个实例"},{"type":"list_item","depth":6,"payload":{"lines":[692,693]},"content":"实例化过程中没有多余的函数调用"},{"type":"list_item","depth":6,"payload":{"lines":[693,694]},"content":"原型上的 constructor 属性指向正确的构造函数"}]}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 寄生组合继承</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\"><span class=\"token maybe-class-name\">Animal</span></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">age</span> <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span><span class=\"token property-access\">age</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">sex</span> <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span><span class=\"token property-access\">sex</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">testProperties</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">eat</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">something</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'eat:'</span><span class=\"token punctuation\">,</span> something<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\"><span class=\"token maybe-class-name\">Person</span></span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 初始化父类，独立各自属性</span>\n  <span class=\"token maybe-class-name\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">=</span> options<span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span> <span class=\"token operator\">||</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 设置原型</span>\n<span class=\"token class-name\">Person</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span> <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">Object</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">create</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Animal</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 修改构造函数</span>\n<span class=\"token class-name\">Person</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">constructor</span> <span class=\"token operator\">=</span> <span class=\"token maybe-class-name\">Person</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Person</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">eat</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">eat</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">something</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">,</span> something<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">Person</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">walk</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">walk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'walking'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> person <span class=\"token operator\">=</span> <span class=\"token function\">newPerson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'jack'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">sex</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nperson<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">eat</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rice'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nperson<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">walk</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> person <span class=\"token operator\">=</span> <span class=\"token function\">newPerson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">age</span><span class=\"token operator\">:</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'rose'</span><span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">sex</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nperson<span class=\"token punctuation\">.</span><span class=\"token property-access\">testProperties</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[727,728]},"content":"es6 继承","children":[{"type":"list_item","depth":4,"payload":{"lines":[729,730]},"content":"特征","children":[{"type":"list_item","depth":5,"payload":{"lines":[730,731]},"content":"extends 关键字"},{"type":"list_item","depth":5,"payload":{"lines":[731,732]},"content":"super 访问父类"}]},{"type":"list_item","depth":4,"payload":{"lines":[732,733]},"content":"注意点：","children":[{"type":"list_item","depth":5,"payload":{"lines":[733,734]},"content":"构造函数 this 使用前，必须先调用 super 方法"},{"type":"list_item","depth":5,"payload":{"lines":[734,735]},"content":"注意箭头函数形式的属性"},{"type":"list_item","depth":5,"payload":{"lines":[735,736]},"content":"class 想在原型上添加非函数的属性，还得依赖 prototype"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[737,738]},"content":"柯里化","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[739,743]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[739,740]},"content":"定义：柯里化是将一个 N 元函数转换为 N 个一元函数，它持续的返回一个新的函数，直至所有的参数用尽为止，然后柯里化链中最后一个函数返回并且执行，才会全部执行。","children":[{"type":"list_item","depth":5,"payload":{"lines":[740,741]},"content":"元：指的是函数参数的数量"}]},{"type":"list_item","depth":4,"payload":{"lines":[741,742]},"content":"简而言之：就是将多元函数转为一元函数"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 简单举例</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">calcSum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num1<span class=\"token punctuation\">,</span> num2<span class=\"token punctuation\">,</span> num3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> num1 <span class=\"token operator\">+</span> num2 <span class=\"token operator\">+</span> num3<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">currySum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num2</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> num1 <span class=\"token operator\">+</span> num2 <span class=\"token operator\">+</span> num3<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">calSum</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">currySum</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> slice <span class=\"token operator\">=</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slice</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">curry</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fn<span class=\"token punctuation\">,</span> length</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> args <span class=\"token operator\">=</span> slice<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> _curry<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fn<span class=\"token punctuation\">,</span> length <span class=\"token operator\">||</span> fn<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">concat</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">_curry</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn<span class=\"token punctuation\">,</span> len</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> oArgs <span class=\"token operator\">=</span> slcie<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> args <span class=\"token operator\">=</span> oArgs<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">concat</span><span class=\"token punctuation\">(</span>slice<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">>=</span> len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> fn<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword control-flow\">else</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword control-flow\">return</span> _curry<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>fn<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">concat</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 使用</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">calSum</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num1<span class=\"token punctuation\">,</span> num2<span class=\"token punctuation\">,</span> num3</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> num1 <span class=\"token operator\">+</span> num2 <span class=\"token operator\">+</span> num3<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> currySum <span class=\"token operator\">=</span> <span class=\"token function\">curry</span><span class=\"token punctuation\">(</span>calSum<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">currySum</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">currySum</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"},{"type":"heading","depth":3,"payload":{"lines":[785,786]},"content":"反柯里化","children":[{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">unCurry</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">context</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> fn<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">apply</span><span class=\"token punctuation\">(</span>context<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">prototype</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">slice</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">call</span><span class=\"token punctuation\">(</span>arguments<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre>\n"},{"type":"bullet_list","depth":4,"payload":{"lines":[795,800]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[795,796]},"content":"反柯里化使用场景","children":[{"type":"list_item","depth":6,"payload":{"lines":[796,797]},"content":"借用数组方法"},{"type":"list_item","depth":6,"payload":{"lines":[797,798]},"content":"复制数组"},{"type":"list_item","depth":6,"payload":{"lines":[798,799]},"content":"发送事件"}]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[800,801]},"content":"链式调用","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[802,829]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[802,803]},"content":"举例","children":[{"type":"list_item","depth":5,"payload":{"lines":[803,804]},"content":"jquery"},{"type":"list_item","depth":5,"payload":{"lines":[804,805]},"content":"数组"},{"type":"list_item","depth":5,"payload":{"lines":[805,806]},"content":"es6 异步操作"},{"type":"list_item","depth":5,"payload":{"lines":[806,807]},"content":"EvenetEmiter"}]},{"type":"list_item","depth":4,"payload":{"lines":[807,808]},"content":"本质","children":[{"type":"list_item","depth":5,"payload":{"lines":[808,809]},"content":"返回对象本身"},{"type":"list_item","depth":5,"payload":{"lines":[809,810]},"content":"返回同类型的实例对象"}]},{"type":"list_item","depth":4,"payload":{"lines":[810,811]},"content":"案例","children":[{"type":"list_item","depth":5,"payload":{"lines":[811,812]},"content":"lodash"},{"type":"list_item","depth":5,"payload":{"lines":[812,813]},"content":"axios"}]},{"type":"list_item","depth":4,"payload":{"lines":[813,814]},"content":"优点","children":[{"type":"list_item","depth":5,"payload":{"lines":[814,815]},"content":"可读性强，语义好理解"},{"type":"list_item","depth":5,"payload":{"lines":[815,816]},"content":"代码简洁，"},{"type":"list_item","depth":5,"payload":{"lines":[816,817]},"content":"易于维护"}]},{"type":"list_item","depth":4,"payload":{"lines":[817,818]},"content":"缺点","children":[{"type":"list_item","depth":5,"payload":{"lines":[818,819]},"content":"编码门槛高"},{"type":"list_item","depth":5,"payload":{"lines":[819,820]},"content":"调试不方便"},{"type":"list_item","depth":5,"payload":{"lines":[820,821]},"content":"消耗大"}]},{"type":"list_item","depth":4,"payload":{"lines":[821,822]},"content":"使用场景","children":[{"type":"list_item","depth":5,"payload":{"lines":[822,823]},"content":"需要多次计算或赋值"},{"type":"list_item","depth":5,"payload":{"lines":[823,824]},"content":"逻辑上有特定的顺序"},{"type":"list_item","depth":5,"payload":{"lines":[824,825]},"content":"相似的业务的集中处理"}]},{"type":"list_item","depth":4,"payload":{"lines":[825,826]},"content":"实现的其他方式","children":[{"type":"list_item","depth":5,"payload":{"lines":[826,827]},"content":"compose"},{"type":"list_item","depth":5,"payload":{"lines":[827,828]},"content":"pipe"}]}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Calculator</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span> <span class=\"token operator\">=</span> value<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 方式1：返回自身</span>\n    <span class=\"token comment\">// this.value = this.value + num;</span>\n    <span class=\"token comment\">// return this;</span>\n    <span class=\"token comment\">// 方式2：返回实例</span>\n    <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span> <span class=\"token operator\">+</span> num<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Calculator</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">minus</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// this.value = this.value - num;</span>\n    <span class=\"token comment\">// return this;</span>\n    <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span> <span class=\"token operator\">-</span> num<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Calculator</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ES5 getter 表现得像属性，实则是一个方法</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">value</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> cal <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Calculator</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> val <span class=\"token operator\">=</span> cal<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">add</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">minus</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">double</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">value</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[858,859]},"content":"解析代码","children":[{"type":"heading","depth":3,"payload":{"lines":[860,861]},"content":"eval","children":[{"type":"list_item","depth":4,"payload":{"lines":[862,863]},"content":"作用：将传入的字符串当作 js 代码执行"},{"type":"list_item","depth":4,"payload":{"lines":[863,864]},"content":"语法：eval(string)"},{"type":"list_item","depth":4,"payload":{"lines":[864,865]},"content":"基本使用：eval('2 + 2')"},{"type":"list_item","depth":4,"payload":{"lines":[865,866]},"content":"使用场景：","children":[{"type":"list_item","depth":5,"payload":{"lines":[866,867]},"content":"系统内部的 setTimeout 或者 setInterval"},{"type":"list_item","depth":5,"payload":{"lines":[867,868]},"content":"JSON 字符串转对象"},{"type":"list_item","depth":5,"payload":{"lines":[868,869]},"content":"前端模板"},{"type":"list_item","depth":5,"payload":{"lines":[869,870]},"content":"动态生成函数或者变量"},{"type":"list_item","depth":5,"payload":{"lines":[870,871]},"content":"有需要跳出严格模式的场景"},{"type":"list_item","depth":5,"payload":{"lines":[871,872]},"content":"......"}]},{"type":"list_item","depth":4,"payload":{"lines":[872,873]},"content":"注意事项：","children":[{"type":"list_item","depth":5,"payload":{"lines":[873,874]},"content":"安全性"},{"type":"list_item","depth":5,"payload":{"lines":[874,875]},"content":"调试困难"},{"type":"list_item","depth":5,"payload":{"lines":[875,876]},"content":"性能低"},{"type":"list_item","depth":5,"payload":{"lines":[876,877]},"content":"门槛高"},{"type":"list_item","depth":5,"payload":{"lines":[877,878]},"content":"可读性和可维护性差"}]},{"type":"list_item","depth":4,"payload":{"lines":[878,879]},"content":"直接调用与间接调用区别","children":[{"type":"list_item","depth":5,"payload":{"lines":[879,880]},"content":"直接调用：","children":[{"type":"list_item","depth":6,"payload":{"lines":[880,881]},"content":"作用域：正常的作用域链"},{"type":"list_item","depth":6,"payload":{"lines":[881,882]},"content":"是否严格模式：继承当前"},{"type":"list_item","depth":6,"payload":{"lines":[882,883]},"content":"方式","children":[{"type":"list_item","depth":7,"payload":{"lines":[883,884]},"content":"eval"},{"type":"list_item","depth":7,"payload":{"lines":[884,885]},"content":"(eval)"},{"type":"list_item","depth":7,"payload":{"lines":[885,886]},"content":"eval=window.eval"},{"type":"list_item","depth":7,"payload":{"lines":[886,887]},"content":"{eval}=window"},{"type":"list_item","depth":7,"payload":{"lines":[887,888]},"content":"with({eval})"}]}]},{"type":"list_item","depth":5,"payload":{"lines":[888,889]},"content":"间接调用：","children":[{"type":"list_item","depth":6,"payload":{"lines":[889,890]},"content":"作用域：只有全局作用域"},{"type":"list_item","depth":6,"payload":{"lines":[890,891]},"content":"是否严格模式：非严格模式"}]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[892,893]},"content":"new Function","children":[{"type":"list_item","depth":3,"payload":{"lines":[894,895]},"content":"作用：创建一个新的 Function"},{"type":"list_item","depth":3,"payload":{"lines":[895,896]},"content":"语法：new Function([arg1,[arg2,[arg3,[...]]]],functionBody)"},{"type":"list_item","depth":3,"payload":{"lines":[896,897]},"content":"基本用法：new Function(&quot;a&quot;,&quot;b&quot;,&quot;return a+b&quot;)(10,20 )"},{"type":"list_item","depth":3,"payload":{"lines":[897,898]},"content":"注意事项：","children":[{"type":"list_item","depth":4,"payload":{"lines":[898,899]},"content":"new Function 基于全局环境创建"},{"type":"list_item","depth":4,"payload":{"lines":[899,900]},"content":"方法的 name 属性是 anonymous"}]},{"type":"list_item","depth":3,"payload":{"lines":[900,901]},"content":"使用场景：","children":[{"type":"list_item","depth":4,"payload":{"lines":[901,902]},"content":"获取 this"},{"type":"list_item","depth":4,"payload":{"lines":[902,903]},"content":"在线运行代码"},{"type":"list_item","depth":4,"payload":{"lines":[903,904]},"content":"模板引擎"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[905,906]},"content":"操作 dom","children":[{"type":"fence","depth":2,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 查看继承关系的方法(手写版)</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getParents</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> el <span class=\"token operator\">!==</span> <span class=\"token string\">'object'</span> <span class=\"token operator\">||</span> el <span class=\"token operator\">===</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'el应该是一个对象'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">var</span> _el <span class=\"token operator\">=</span> el<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> result <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword control-flow\">while</span> <span class=\"token punctuation\">(</span>_el<span class=\"token punctuation\">.</span><span class=\"token property-access\">__proto__</span> <span class=\"token operator\">!==</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    result<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span>_el<span class=\"token punctuation\">.</span><span class=\"token class-name\">__proto__</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">constructor</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n      _el <span class=\"token operator\">=</span> _el<span class=\"token punctuation\">.</span><span class=\"token property-access\">__proto__</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">getParents</span><span class=\"token punctuation\">(</span><span class=\"token dom variable\">document</span><span class=\"token punctuation\">)</span>\n</code></pre>\n"},{"type":"heading","depth":2,"payload":{"lines":[924,925]},"content":"nodeType","children":[{"type":"heading","depth":3,"payload":{"lines":[926,927]},"content":"主要类型","children":[{"type":"list_item","depth":4,"payload":{"lines":[928,929]},"content":"元素节点：Node.ELEMENT_NODE，1"},{"type":"list_item","depth":4,"payload":{"lines":[929,930]},"content":"文本:NODE.TEXT_NODE，3","children":[{"type":"list_item","depth":5,"payload":{"lines":[930,931]},"content":"访问：childNodes"},{"type":"list_item","depth":5,"payload":{"lines":[931,932]},"content":"取值：nodeValue"},{"type":"list_item","depth":5,"payload":{"lines":[932,933]},"content":"拆解文本：splitText"},{"type":"list_item","depth":5,"payload":{"lines":[933,934]},"content":"合并文本：Element.normailze"}]},{"type":"list_item","depth":4,"payload":{"lines":[934,935]},"content":"注释:NODE.COMMENT_NODE，8","children":[{"type":"list_item","depth":5,"payload":{"lines":[935,936]},"content":"取值：nodeValue"}]},{"type":"list_item","depth":4,"payload":{"lines":[936,937]},"content":"文档类型:DOCUMENT_NODE，9","children":[{"type":"list_item","depth":5,"payload":{"lines":[937,938]},"content":"节点查找：document.querySelector，document.querySelectorAll 等"},{"type":"list_item","depth":5,"payload":{"lines":[938,939]},"content":"节点结合信息：document.all，ducument.scripts,document.images 等"},{"type":"list_item","depth":5,"payload":{"lines":[939,940]},"content":"cookie：document.cookie"}]},{"type":"list_item","depth":4,"payload":{"lines":[940,941]},"content":"文档:DOCUMENT_TYPE_NODE，10","children":[{"type":"list_item","depth":5,"payload":{"lines":[941,942]},"content":"访问：document.type，document.firstChild"}]},{"type":"list_item","depth":4,"payload":{"lines":[942,943]},"content":"文档碎片:DOCUMENT_FRAGMENT_NODE，11","children":[{"type":"list_item","depth":5,"payload":{"lines":[943,944]},"content":"所有节点都会一次性的插入文档 ducument 中，仅发生一次重渲染"},{"type":"list_item","depth":5,"payload":{"lines":[944,945]},"content":"常用于批量创建大量节点，提高性能"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[946,947]},"content":"element 系列","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[948,952]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[948,949]},"content":"创建：document.createElement"},{"type":"list_item","depth":4,"payload":{"lines":[949,950]},"content":"children(nodeType = 1)和 childNodes(全部)"},{"type":"list_item","depth":4,"payload":{"lines":[950,951]},"content":"获取属性 getAtribute，设置属性：setAttribute"}]},{"type":"heading","depth":3,"payload":{"lines":[952,953]},"content":"Node 与 element","children":[{"type":"list_item","depth":4,"payload":{"lines":[954,955]},"content":"node 定义：node 是一个接口，成为节点"},{"type":"list_item","depth":4,"payload":{"lines":[955,956]},"content":"lelement 定义：nodeType===1，是元素，为 element"}]},{"type":"heading","depth":3,"payload":{"lines":[957,958]},"content":"HTMLCollection 和 NodeList","children":[{"type":"list_item","depth":4,"payload":{"lines":[959,960]},"content":"HTMLCollection：子类的集合，元素集合"},{"type":"list_item","depth":4,"payload":{"lines":[960,961]},"content":"NodeList：所有 node 子类的集合，节点列表"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[962,963]},"content":"操作 dom/node 节点","children":[{"type":"heading","depth":2,"payload":{"lines":[964,965]},"content":"增加与查找总结","children":[{"type":"thead","depth":3,"payload":{"lines":[966,967]},"content":"","children":[{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"方法名"},{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"单个元素"},{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"节点列表"},{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"元素集合"},{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"元素也拥有"},{"type":"th","depth":4,"payload":{"lines":[966,967]},"content":"实时更新"}]},{"type":"tbody","depth":3,"payload":{"lines":[968,974]},"content":"","children":[{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"getElementById"},{"type":"td","depth":5,"payload":{},"content":"√"}]},{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"querySelector"},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"}]},{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"getElementsByClassName"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":"√"}]},{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"getElementsByName"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"}]},{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"getElementsByTagName"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":"√"}]},{"type":"tr","depth":4,"payload":{},"content":"","children":[{"type":"td","depth":5,"payload":{},"content":"querySelectorAll"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":""},{"type":"td","depth":5,"payload":{},"content":"√"},{"type":"td","depth":5,"payload":{},"content":"√"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[975,976]},"content":"查询伪元素","children":[{"type":"list_item","depth":3,"payload":{"lines":[977,978]},"content":"不能查询为元素"},{"type":"list_item","depth":3,"payload":{"lines":[978,979]},"content":"但是能获取到样式：window.getComputedStyle"}]},{"type":"heading","depth":2,"payload":{"lines":[980,981]},"content":"元素集合与 Nodelist 遍历","children":[{"type":"list_item","depth":3,"payload":{"lines":[982,983]},"content":"for/while 遍历"},{"type":"list_item","depth":3,"payload":{"lines":[983,984]},"content":"NodeList.prototype.forEach"},{"type":"list_item","depth":3,"payload":{"lines":[984,985]},"content":"也可以转为数组进行遍历：Array.from，Array.prototypr.slice 等等"}]},{"type":"heading","depth":2,"payload":{"lines":[986,987]},"content":"某节点/元素所有子节点/元素","children":[{"type":"list_item","depth":3,"payload":{"lines":[988,989]},"content":"children/childNodes"},{"type":"list_item","depth":3,"payload":{"lines":[989,990]},"content":"Nodelterator 或者 TreeWalker"},{"type":"list_item","depth":3,"payload":{"lines":[990,991]},"content":"区别：","children":[{"type":"list_item","depth":4,"payload":{"lines":[991,992]},"content":"TreeWalker 是 nodeLterator 的更高版本"},{"type":"list_item","depth":4,"payload":{"lines":[992,993]},"content":"额外有：parentNode，firstChild，lastChild，nextSibling"}]}]},{"type":"heading","depth":2,"payload":{"lines":[994,995]},"content":"node 对象方法","children":[{"type":"list_item","depth":3,"payload":{"lines":[996,997]},"content":"appendChild"},{"type":"list_item","depth":3,"payload":{"lines":[997,998]},"content":"insertBefore"},{"type":"list_item","depth":3,"payload":{"lines":[998,999]},"content":"replaceChild"},{"type":"list_item","depth":3,"payload":{"lines":[999,1000]},"content":"textContent"}]},{"type":"heading","depth":2,"payload":{"lines":[1001,1002]},"content":"Element 对象方法","children":[{"type":"list_item","depth":3,"payload":{"lines":[1003,1004]},"content":"after&amp;before"},{"type":"list_item","depth":3,"payload":{"lines":[1004,1005]},"content":"append&amp;prepend"},{"type":"list_item","depth":3,"payload":{"lines":[1005,1006]},"content":"insertAdjacent 系列"},{"type":"list_item","depth":3,"payload":{"lines":[1006,1007]},"content":"replaceChildren&amp;replaceWith"},{"type":"list_item","depth":3,"payload":{"lines":[1007,1008]},"content":"insertHTML&amp;innerText"}]},{"type":"heading","depth":2,"payload":{"lines":[1009,1010]},"content":"节点复制","children":[{"type":"list_item","depth":3,"payload":{"lines":[1011,1012]},"content":"Node.cloneNode","children":[{"type":"list_item","depth":4,"payload":{"lines":[1012,1013]},"content":"节点克隆"},{"type":"list_item","depth":4,"payload":{"lines":[1013,1014]},"content":"分为浅克隆与深克隆"}]},{"type":"list_item","depth":3,"payload":{"lines":[1014,1015]},"content":"Document.importNode"},{"type":"list_item","depth":3,"payload":{"lines":[1015,1016]},"content":"Document.adoptNode"},{"type":"list_item","depth":3,"payload":{"lines":[1016,1017]},"content":"Element.innerHTML"}]},{"type":"heading","depth":2,"payload":{"lines":[1018,1019]},"content":"批量删除","children":[{"type":"list_item","depth":3,"payload":{"lines":[1020,1021]},"content":"outerHTML&amp;innerHTML"},{"type":"list_item","depth":3,"payload":{"lines":[1021,1022]},"content":"循环删除"}]},{"type":"heading","depth":2,"payload":{"lines":[1023,1024]},"content":"创建节点","children":[{"type":"list_item","depth":3,"payload":{"lines":[1025,1026]},"content":"对象模型直接 new"},{"type":"list_item","depth":3,"payload":{"lines":[1026,1027]},"content":"document.create 系列"}]},{"type":"heading","depth":2,"payload":{"lines":[1028,1029]},"content":"删除节点","children":[{"type":"list_item","depth":3,"payload":{"lines":[1030,1031]},"content":"Node.removeNode"},{"type":"list_item","depth":3,"payload":{"lines":[1031,1032]},"content":"Element.remove"},{"type":"list_item","depth":3,"payload":{"lines":[1032,1033]},"content":"outerHTML&amp;innerHTML"},{"type":"list_item","depth":3,"payload":{"lines":[1033,1034]},"content":"Document.adoptNode"}]},{"type":"heading","depth":2,"payload":{"lines":[1035,1036]},"content":"内存泄露","children":[{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// dom元素或者时间监听操作手动清空</span>\n<span class=\"token keyword\">var</span> root <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> div <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ndiv<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">(</span><span class=\"token string\">'文本'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">appendChild</span><span class=\"token punctuation\">(</span>div<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 经过一系列操作</span>\nroot<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">removeChild</span><span class=\"token punctuation\">(</span>div<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 挂载到window上，未清除</span>\n\n<span class=\"token comment\">// 检查div是否回收</span>\n<span class=\"token keyword\">const</span> wkRef <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">WeakRef</span><span class=\"token punctuation\">(</span>div<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>wkRef<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">deref</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;div>文本&lt;/div> 存在</span>\ndiv <span class=\"token operator\">=</span> <span class=\"token keyword null nil\">null</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 手动清除</span>\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>wkRef<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">deref</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 闭包：立即执行函数来清除</span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[1056,1057]},"content":"相似的知识点","children":[{"type":"heading","depth":3,"payload":{"lines":[1058,1059]},"content":"文本","children":[{"type":"list_item","depth":4,"payload":{"lines":[1060,1061]},"content":"HTML.element.innerText"},{"type":"list_item","depth":4,"payload":{"lines":[1061,1062]},"content":"Node.textContent","children":[{"type":"thead","depth":5,"payload":{"lines":[1062,1063]},"content":"","children":[{"type":"th","depth":6,"payload":{"lines":[1062,1063]},"content":"</br>"},{"type":"th","depth":6,"payload":{"lines":[1062,1063]},"content":"Node.textContent"},{"type":"th","depth":6,"payload":{"lines":[1062,1063]},"content":"HTMLElement.innerText"}]},{"type":"tbody","depth":5,"payload":{"lines":[1064,1068]},"content":"","children":[{"type":"tr","depth":6,"payload":{},"content":"","children":[{"type":"td","depth":7,"payload":{},"content":"style,script 标签，隐藏的内容（diplay:none）"},{"type":"td","depth":7,"payload":{},"content":"包含"},{"type":"td","depth":7,"payload":{},"content":"不包含"}]},{"type":"tr","depth":6,"payload":{},"content":"","children":[{"type":"td","depth":7,"payload":{},"content":"br 标签"},{"type":"td","depth":7,"payload":{},"content":"无效"},{"type":"td","depth":7,"payload":{},"content":"有效"}]},{"type":"tr","depth":6,"payload":{},"content":"","children":[{"type":"td","depth":7,"payload":{},"content":"\\t、\\n 等转义字符"},{"type":"td","depth":7,"payload":{},"content":"有效"},{"type":"td","depth":7,"payload":{},"content":"不包含"}]},{"type":"tr","depth":6,"payload":{},"content":"","children":[{"type":"td","depth":7,"payload":{},"content":"连续空格"},{"type":"td","depth":7,"payload":{},"content":"有效"},{"type":"td","depth":7,"payload":{},"content":"合并为一个"}]}]}]}]},{"type":"heading","depth":3,"payload":{"lines":[1069,1070]},"content":"节点值","children":[{"type":"list_item","depth":4,"payload":{"lines":[1071,1072]},"content":"value：是特定的 HTMLElement 元素属性"},{"type":"list_item","depth":4,"payload":{"lines":[1072,1073]},"content":"Node.nodeValue：是节点的值"}]},{"type":"heading","depth":3,"payload":{"lines":[1074,1075]},"content":"宽高","children":[{"type":"list_item","depth":4,"payload":{"lines":[1076,1077]},"content":"element.clientWidth/clientHeight","children":[{"type":"list_item","depth":5,"payload":{"lines":[1077,1078]},"content":"元素的宽高：width + padding（不包含 border，margin，滚动条）"}]},{"type":"list_item","depth":4,"payload":{"lines":[1078,1079]},"content":"HTMLElement.offsetWidth/offsetHeight","children":[{"type":"list_item","depth":5,"payload":{"lines":[1079,1080]},"content":"元素局部宽高：width + padding + border + 滚动条（不包含 margin）"}]},{"type":"list_item","depth":4,"payload":{"lines":[1080,1081]},"content":"Element.scollWidth/scrollHeight","children":[{"type":"list_item","depth":5,"payload":{"lines":[1081,1083]},"content":"元素内容宽高：width + padding + 溢出内容（包括由于元素内容 overflow 溢出屏幕的不可见内容）<br>\n<img src='./images/03.png'>"}]}]},{"type":"heading","depth":3,"payload":{"lines":[1084,1085]},"content":"位置关系","children":[{"type":"list_item","depth":4,"payload":{"lines":[1086,1087]},"content":"Node.contains","children":[{"type":"list_item","depth":5,"payload":{"lines":[1087,1088]},"content":"定义：返回值为布尔值，传入节点是否为该节点的后代节点"}]},{"type":"list_item","depth":4,"payload":{"lines":[1088,1089]},"content":"Node.compareDocumentPosition","children":[{"type":"list_item","depth":5,"payload":{"lines":[1089,1090]},"content":"定义：返回值是数字，比较当前节点与任意文档中的另一个节点的位置关系"}]},{"type":"list_item","depth":4,"payload":{"lines":[1090,1091]},"content":"Element.getBoundingClientRect","children":[{"type":"list_item","depth":5,"payload":{"lines":[1091,1092]},"content":"定义：返回元素大小及其相对可视化窗口（导航栏下面的窗口）（视口）的位置"}]},{"type":"list_item","depth":4,"payload":{"lines":[1092,1093]},"content":"Element.getClientRects","children":[{"type":"list_item","depth":5,"payload":{"lines":[1093,1094]},"content":"定义：返回盒子编剧矩形集合"}]}]},{"type":"heading","depth":3,"payload":{"lines":[1095,1096]},"content":"加载","children":[{"type":"list_item","depth":4,"payload":{"lines":[1097,1098]},"content":"window.onload（后）","children":[{"type":"list_item","depth":5,"payload":{"lines":[1098,1099]},"content":"在文档加载完成后会触发 onload 事件。此时，在文档中的所有对象在 DOM 中，所有图片，脚本，链接以及子框架完成了装载。"}]},{"type":"list_item","depth":4,"payload":{"lines":[1099,1100]},"content":"DOMContentLoaded（先）","children":[{"type":"list_item","depth":5,"payload":{"lines":[1100,1101]},"content":"在初始化的 HTML 文档被完全加载和解析完成之后，DOMContentLoaded 事件被触发，而无需等待样式表，图像和子框架（iframe）的完全加载。"}]}]},{"type":"heading","depth":3,"payload":{"lines":[1102,1103]},"content":"子节点集合","children":[{"type":"list_item","depth":4,"payload":{"lines":[1104,1105]},"content":"Node.childNodes","children":[{"type":"list_item","depth":5,"payload":{"lines":[1105,1106]},"content":"节点的子节点集合，包括元素节点，文本节点..."}]},{"type":"list_item","depth":4,"payload":{"lines":[1106,1107]},"content":"Element.children","children":[{"type":"list_item","depth":5,"payload":{"lines":[1107,1108]},"content":"返回的只是节点的元素节点集合，即 nodeType 为 1 的节点"}]}]},{"type":"heading","depth":3,"payload":{"lines":[1109,1110]},"content":"添加节点","children":[{"type":"list_item","depth":4,"payload":{"lines":[1111,1112]},"content":"Node.appendChild","children":[{"type":"list_item","depth":5,"payload":{"lines":[1112,1113]},"content":"将一个子节点附加到指定父节点的子节点列表的末尾"}]},{"type":"list_item","depth":4,"payload":{"lines":[1113,1114]},"content":"Element.append","children":[{"type":"list_item","depth":5,"payload":{"lines":[1114,1115]},"content":"在父节点的最后一个子节点插入一组 node 对象或者 DOMString 对象"}]}]},{"type":"heading","depth":3,"payload":{"lines":[1116,1117]},"content":"克隆和导入","children":[{"type":"list_item","depth":4,"payload":{"lines":[1118,1119]},"content":"Document.adoptNode","children":[{"type":"list_item","depth":5,"payload":{"lines":[1119,1120]},"content":"从外部文档拷贝一份到当前文档"}]},{"type":"list_item","depth":4,"payload":{"lines":[1120,1121]},"content":"Document.importNode","children":[{"type":"list_item","depth":5,"payload":{"lines":[1121,1122]},"content":"从外部文档获取一个节点并删除外部文档节点"}]},{"type":"list_item","depth":4,"payload":{"lines":[1122,1123]},"content":"Node.cloneNode","children":[{"type":"list_item","depth":5,"payload":{"lines":[1123,1124]},"content":"从本文档进行复制，分为浅克隆与深克隆"}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[1125,1126]},"content":"web component","children":[{"type":"heading","depth":3,"payload":{"lines":[1127,1128]},"content":"使用步骤","children":[{"type":"bullet_list","depth":4,"payload":{"lines":[1129,1133]},"content":"","children":[{"type":"list_item","depth":5,"payload":{"lines":[1129,1130]},"content":"编写 Web Component 组件"},{"type":"list_item","depth":5,"payload":{"lines":[1130,1131]},"content":"注册 Web Component 组件"},{"type":"list_item","depth":5,"payload":{"lines":[1131,1132]},"content":"使用"}]},{"type":"fence","depth":4,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>my<span class=\"token operator\">-</span>test<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>my<span class=\"token operator\">-</span>test<span class=\"token operator\">></span> <span class=\"token comment\">// 使用</span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\n    <span class=\"token comment\">// 自定义</span>\n    <span class=\"token keyword\">class</span> <span class=\"token class-name\">myTest</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">HTMLElement</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'文本'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">customElements</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"my-test\"</span><span class=\"token punctuation\">,</span>myTest<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 注册</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n</code></pre>\n"}]},{"type":"heading","depth":3,"payload":{"lines":[1147,1148]},"content":"优点","children":[{"type":"list_item","depth":4,"payload":{"lines":[1149,1150]},"content":"W3C web 标准"},{"type":"list_item","depth":4,"payload":{"lines":[1150,1151]},"content":"兼容性相对较好"},{"type":"list_item","depth":4,"payload":{"lines":[1151,1152]},"content":"天然模块化，自带样式隔离"},{"type":"list_item","depth":4,"payload":{"lines":[1152,1153]},"content":"开箱即用"}]}]},{"type":"heading","depth":2,"payload":{"lines":[1154,1155]},"content":"适用场景","children":[{"type":"list_item","depth":3,"payload":{"lines":[1156,1157]},"content":"组件库"},{"type":"list_item","depth":3,"payload":{"lines":[1157,1158]},"content":"微前端"}]},{"type":"heading","depth":2,"payload":{"lines":[1159,1160]},"content":"custom elements","children":[{"type":"list_item","depth":3,"payload":{"lines":[1161,1162]},"content":"自主定制元素"},{"type":"list_item","depth":3,"payload":{"lines":[1162,1163]},"content":"自定义内置元素"},{"type":"list_item","depth":3,"payload":{"lines":[1163,1164]},"content":"生命周期"},{"type":"list_item","depth":3,"payload":{"lines":[1164,1165]},"content":"name 必须包含一个：-"}]},{"type":"heading","depth":2,"payload":{"lines":[1166,1167]},"content":"HTML templates","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[1168,1175]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[1168,1169]},"content":"标签 template","children":[{"type":"list_item","depth":5,"payload":{"lines":[1169,1170]},"content":"节点"},{"type":"list_item","depth":5,"payload":{"lines":[1170,1171]},"content":"样式"}]},{"type":"list_item","depth":4,"payload":{"lines":[1171,1172]},"content":"slot：需要配合 shadowDoms"},{"type":"list_item","depth":4,"payload":{"lines":[1172,1173]},"content":"样式隔离","children":[{"type":"list_item","depth":5,"payload":{"lines":[1173,1174]},"content":"shadow DOM"}]}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// template</span>\n<span class=\"token operator\">&lt;</span>template id<span class=\"token operator\">=</span><span class=\"token string\">\"tpl-product-item\"</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"name\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"price\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>product<span class=\"token operator\">-</span>item name<span class=\"token operator\">=</span><span class=\"token string\">\"产品\"</span> price<span class=\"token operator\">=</span><span class=\"token string\">\"90\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>product<span class=\"token operator\">-</span>item<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ProductItem</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">HTMLElement</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span>\n      <span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tpl-product-item'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token property-access\">connect</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">cloneNode</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">append</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.price'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">innerText</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'price'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">customElements</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">'product-item'</span><span class=\"token punctuation\">,</span> <span class=\"token maybe-class-name\">ProductItem</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n</code></pre>\n"},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// slot</span>\n<span class=\"token operator\">&lt;</span>template id<span class=\"token operator\">=</span><span class=\"token string\">'tpl-test'</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>style type<span class=\"token operator\">=</span><span class=\"token string\">'text/css'</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">{</span><span class=\"token literal-property property\">color</span><span class=\"token operator\">:</span>red<span class=\"token punctuation\">}</span>\n\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">'title'</span><span class=\"token operator\">></span>标题<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>slot name<span class=\"token operator\">=</span><span class=\"token string\">'slot-des'</span><span class=\"token operator\">></span>默认内容<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>slot<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>test<span class=\"token operator\">-</span>item<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>div slot<span class=\"token operator\">=</span><span class=\"token string\">\"slot-des\"</span><span class=\"token operator\">></span>不是默认内容<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>test<span class=\"token operator\">-</span>item<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TestItem</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">HTMLElement</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">connectedCallback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'tpl-test'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">content</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">cloneDeep</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// this.append(content); // 不生效</span>\n    <span class=\"token keyword\">const</span> shadow <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">attachShadow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">mode</span><span class=\"token operator\">:</span> <span class=\"token string\">'open'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    shadow<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">append</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">customElements</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">define</span><span class=\"token punctuation\">(</span><span class=\"token string\">'test-item'</span><span class=\"token punctuation\">,</span> <span class=\"token maybe-class-name\">TestItem</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n</code></pre>\n"}]},{"type":"heading","depth":2,"payload":{"lines":[1230,1231]},"content":"生命周期","children":[{"type":"list_item","depth":3,"payload":{"lines":[1232,1233]},"content":"connectedCallback：插入文档时"},{"type":"list_item","depth":3,"payload":{"lines":[1233,1234]},"content":"disconnectedCallback：从文档删除时"},{"type":"list_item","depth":3,"payload":{"lines":[1234,1235]},"content":"adoptedCallback：被移入新文档时"},{"type":"list_item","depth":3,"payload":{"lines":[1235,1236]},"content":"attributeChangedCallback：属性变化时"},{"type":"list_item","depth":3,"payload":{"lines":[1237,1238]},"content":"场景：","children":[{"type":"list_item","depth":4,"payload":{"lines":[1238,1239]},"content":"插入文档时：","children":[{"type":"list_item","depth":5,"payload":{"lines":[1239,1240],"index":1},"content":"1. attributeChangedCallback"},{"type":"list_item","depth":5,"payload":{"lines":[1240,1241],"index":2},"content":"2. connectedCallback"}]},{"type":"list_item","depth":4,"payload":{"lines":[1241,1243]},"content":"属性更新时：<br>\n1.attributeChangedCallback"},{"type":"list_item","depth":4,"payload":{"lines":[1243,1245]},"content":"删除时：<br>\n1.disconnectedCallback"},{"type":"list_item","depth":4,"payload":{"lines":[1245,1249]},"content":"随文档移动时：<br>\n1.disconnectedCallback<br>\n2.adoptedCallback<br>\n3.connectedCallback"}]}]},{"type":"heading","depth":2,"payload":{"lines":[1250,1251]},"content":"shadow DOM","children":[{"type":"list_item","depth":3,"payload":{"lines":[1252,1253]},"content":"影子 DOM，其内部样式不共享"},{"type":"list_item","depth":3,"payload":{"lines":[1253,1254]},"content":"影子 DOM，其内部元素不可以直接被访问到"},{"type":"list_item","depth":3,"payload":{"lines":[1254,1255]},"content":"参数：mode（'open'/'closed'）","children":[{"type":"list_item","depth":4,"payload":{"lines":[1255,1256]},"content":"open：shadow root 元素可以从 js 外部访问根节点"},{"type":"list_item","depth":4,"payload":{"lines":[1256,1257]},"content":"closed：拒绝从 js 外部访问关闭的 shadow root 节点"}]}]}]},{"type":"heading","depth":1,"payload":{"lines":[1258,1259]},"content":"DOM 事件原理","children":[{"type":"bullet_list","depth":2,"payload":{"lines":[1263,1266]},"content":"","children":[{"type":"list_item","depth":3,"payload":{"lines":[1263,1264]},"content":"关系：","children":[{"type":"list_item","depth":4,"payload":{"lines":[1264,1265]},"content":"window 属于 BOM，document 是 DOM 核心，但是 window 饮用者 document，仅此而已"}]}]},{"type":"heading","depth":2,"payload":{"lines":[1266,1267]},"content":"DOM0 级事件","children":[{"type":"list_item","depth":3,"payload":{"lines":[1268,1269]},"content":"定义：以“onclick”形式在元素属性上的事件"},{"type":"list_item","depth":3,"payload":{"lines":[1269,1270]},"content":"优点：","children":[{"type":"list_item","depth":4,"payload":{"lines":[1270,1271]},"content":"效率高"},{"type":"list_item","depth":4,"payload":{"lines":[1271,1272]},"content":"移除事件非常简单"},{"type":"list_item","depth":4,"payload":{"lines":[1272,1273]},"content":"节点上 onclick 属性可以被 Node.cloneNode 克隆，但通过 js 动态添加的 onclick 不可以"}]},{"type":"list_item","depth":3,"payload":{"lines":[1273,1274]},"content":"注意：","children":[{"type":"list_item","depth":4,"payload":{"lines":[1274,1275]},"content":"事件处理函数中，this 是当前的节点"},{"type":"list_item","depth":4,"payload":{"lines":[1275,1276]},"content":"如果调用函数，会在全局作用域中查找"},{"type":"list_item","depth":4,"payload":{"lines":[1276,1277]},"content":"唯一性，只能定义一个事件的回调函数"}]}]},{"type":"heading","depth":2,"payload":{"lines":[1278,1279]},"content":"DOM2 级事件","children":[{"type":"bullet_list","depth":3,"payload":{"lines":[1281,1283]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[1281,1282]},"content":"事件注册"}]},{"type":"fence","depth":3,"content":"<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// useCapture:true，捕获阶段传播到目标的时候触发，反之冒泡阶段传到目标的时候触发。默认值为false，即冒泡时</span>\ntarget<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEvenetListener</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> listener<span class=\"token punctuation\">,</span> useCapture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// options:</span>\n<span class=\"token comment\">// - once：是否只响应一次，典型：视频播放</span>\n<span class=\"token comment\">// - passive:true 时，事件处理不会调用 preventDefault，提升滚动性能</span>\n<span class=\"token comment\">// - signal:abortSignal 的 abort()方法被调用时，监听器会被移除</span>\ntarget<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">addEvenetListener</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> listener<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code></pre>\n"},{"type":"bullet_list","depth":3,"payload":{"lines":[1293,1303]},"content":"","children":[{"type":"list_item","depth":4,"payload":{"lines":[1293,1294]},"content":"event.preventDefault：阻止默认的行为，如 a 标签不会跳转，checkbox 不会选中等等"},{"type":"list_item","depth":4,"payload":{"lines":[1294,1295]},"content":"stopPropagation：阻止捕获和冒泡中当前事件的进一步传播。"},{"type":"list_item","depth":4,"payload":{"lines":[1295,1296]},"content":"stopImmediatePropagation：阻止监听同一事件的其他事件监听被调用。"},{"type":"list_item","depth":4,"payload":{"lines":[1296,1297]},"content":"target：触发事件的元素。"},{"type":"list_item","depth":4,"payload":{"lines":[1297,1298]},"content":"currentTarget：事件绑定的元素。"},{"type":"list_item","depth":4,"payload":{"lines":[1298,1299]},"content":"事件委托：利用事件传播的机制，利用外层节点处理事件的思路","children":[{"type":"list_item","depth":5,"payload":{"lines":[1299,1300]},"content":"优点：","children":[{"type":"list_item","depth":6,"payload":{"lines":[1300,1301]},"content":"减少内存消耗"},{"type":"list_item","depth":6,"payload":{"lines":[1301,1302]},"content":"动态性更好"}]}]}]}]},{"type":"heading","depth":2,"payload":{"lines":[1303,1304]},"content":"DOM3 级事件","children":[{"type":"list_item","depth":3,"payload":{"lines":[1305,1306]},"content":"用户界面事件：涉及 BOM 交互的通用浏览器事件，如 load，scroll......"},{"type":"list_item","depth":3,"payload":{"lines":[1306,1307]},"content":"焦点事件：元素获得和失去焦点触发，如 focus，blur"},{"type":"list_item","depth":3,"payload":{"lines":[1307,1308]},"content":"鼠标事件：使用鼠标在页面上执行某些操作触发"},{"type":"list_item","depth":3,"payload":{"lines":[1308,1309]},"content":"滚轮事件"},{"type":"list_item","depth":3,"payload":{"lines":[1309,1310]},"content":"输入事件"},{"type":"list_item","depth":3,"payload":{"lines":[1310,1311]},"content":"键盘事件"},{"type":"list_item","depth":3,"payload":{"lines":[1311,1312]},"content":"合成事件：在使用某种 IME（输入法编辑器）输入字符触发"}]},{"type":"heading","depth":2,"payload":{"lines":[1313,1314]},"content":"注意事项","children":[{"type":"list_item","depth":3,"payload":{"lines":[1315,1316]},"content":"DOM0 级事件，在一定程度上可以复制"},{"type":"list_item","depth":3,"payload":{"lines":[1316,1317]},"content":"DOM2 级事件不可复制"},{"type":"list_item","depth":3,"payload":{"lines":[1317,1318]},"content":"合理使用 once 选项"},{"type":"list_item","depth":3,"payload":{"lines":[1318,1319]},"content":"合理使用 passive 选项提升性能"},{"type":"list_item","depth":3,"payload":{"lines":[1319,1320]},"content":"capture 选项相同并且事件回调函数相同，事件不会被添加"},{"type":"list_item","depth":3,"payload":{"lines":[1320,1321]},"content":"因为都是继承于 EventTarget，任何一个节点都是事件中心"},{"type":"list_item","depth":3,"payload":{"lines":[1321,1322]},"content":"合理利用事件代理"}]}]}],"payload":{}},{})</script>
</body>
</html>
